@model AppIntegrador.Models.PermissionsViewHolder
@{
    ViewBag.Title = "Index";
}

    <div class="container">
        <div class="row" style="display:flex; padding-left:15px; ">
            <div class="column" style="flex:50%;">
                <h2>
                    Administración de permisos y perfiles
                </h2>
            </div>
        </div>
        <br />
        @using (Html.BeginForm("Index", "Permissions", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post))
        {
            <div class="row" style="display:flex; padding-left:15px; ">
                <div class="col-md-4" style="flex:50%;">
                    @Html.Label("Seleccione un perfil")
                    <br />

                    @Html.ListBoxFor(model => model.PerfilesSeleccionados, Model.ListaPerfiles, new { @class = "selectpicker" })
                    <br />
                </div>
                <div class="col-md-4" style="flex:50%;">
                    @Html.Label("Seleccione una carrera")
                    <br />

                    @Html.ListBoxFor(model => model.CarrerasSeleccionadas, Model.ListaCarreras, new { @class = "selectpicker" })
                    <br />
                </div>
                <div class="col-md-4" style="flex:50%;">
                    @Html.Label("Seleccione un énfasis")
                    <br />
                    @Html.ListBoxFor(model => model.EnfasisSeleccionados, Model.ListaEnfasis, new { @class = "selectpicker" })
                    <br />
                </div>
            </div>
            
            <input id="create-save" type="submit" value="Crear" class="btn btn-success" />
        }
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.8.1/css/bootstrap-select.css">

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/custom")

<!--Código jQuery para cargar en el select de énfasis los énfasis asociados a la carrera elegida.-->
<script>
    $("#CarrerasSeleccionada").on("change", function () {
        cargarEnfasis($(this).val());
    })

    function cargarEnfasis(val)
    {
        $.getJSON('@Url.Action("CargarEnfasisDeCarrera", "Permissions")' + "?value=" + val, function (result) {
            var data = result.data;
            for (var i = 0; i < data.length; ++i) {
                $("#EnfasisSeleccionado").append("<option>" + data[i] + "</option>")
            }
        })
    }
</script>
